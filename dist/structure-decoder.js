var decodeStructure=function(){"use strict";function r(r){function t(r){for(var t={},e=0;r>e;e++){var n=i();t[n]=i()}return t}function e(t){var e=r.subarray(o,o+t);return o+=t,e}function n(t){var e=r.subarray(o,o+t),n=String.fromCharCode.apply(null,e);return o+=t,n}function a(r){for(var t=new Array(r),e=0;r>e;e++)t[e]=i();return t}function i(){var i,c,s,f=r[o];if(0===(128&f))return o++,f;if(128===(240&f))return c=15&f,o++,t(c);if(144===(240&f))return c=15&f,o++,a(c);if(160===(224&f))return c=31&f,o++,n(c);if(224===(224&f))return i=u.getInt8(o),o++,i;switch(f){case 192:return o++,null;case 194:return o++,!1;case 195:return o++,!0;case 196:return c=u.getUint8(o+1),o+=2,e(c);case 197:return c=u.getUint16(o+1),o+=3,e(c);case 198:return c=u.getUint32(o+1),o+=5,e(c);case 199:return c=u.getUint8(o+1),s=u.getUint8(o+2),o+=3,[s,e(c)];case 200:return c=u.getUint16(o+1),s=u.getUint8(o+3),o+=4,[s,e(c)];case 201:return c=u.getUint32(o+1),s=u.getUint8(o+5),o+=6,[s,e(c)];case 202:return i=u.getFloat32(o+1),o+=5,i;case 203:return i=u.getFloat64(o+1),o+=9,i;case 204:return i=r[o+1],o+=2,i;case 205:return i=u.getUint16(o+1),o+=3,i;case 206:return i=u.getUint32(o+1),o+=5,i;case 207:return o+=9,0;case 208:return i=u.getInt8(o+1),o+=2,i;case 209:return i=u.getInt16(o+1),o+=3,i;case 210:return i=u.getInt32(o+1),o+=5,i;case 211:return o+=9,0;case 212:return s=u.getUint8(o+1),o+=2,[s,e(1)];case 213:return s=u.getUint8(o+1),o+=2,[s,e(2)];case 214:return s=u.getUint8(o+1),o+=2,[s,e(4)];case 215:return s=u.getUint8(o+1),o+=2,[s,e(8)];case 216:return s=u.getUint8(o+1),o+=2,[s,e(16)];case 217:return c=u.getUint8(o+1),o+=2,n(c);case 218:return c=u.getUint16(o+1),o+=3,n(c);case 219:return c=u.getUint32(o+1),o+=5,n(c);case 220:return c=u.getUint16(o+1),o+=3,a(c);case 221:return c=u.getUint32(o+1),o+=5,a(c);case 222:return c=u.getUint16(o+1),o+=3,t(c);case 223:return c=u.getUint32(o+1),o+=5,t(c)}throw new Error("Unknown type 0x"+f.toString(16))}var o=0,u=new DataView(r.buffer);return i()}function t(r,t){var e=new DataView(r.buffer),n=r.byteOffset,a=r.byteLength;t||(t=new Int8Array(a));for(var i=0;a>i;++i)t[i]=e.getInt8(n+i);return t}function e(r,t,e){var n=new DataView(r.buffer),a=r.byteOffset,i=r.byteLength;t||(t=new Int16Array(i/2));for(var o=0,u=i/2;u>o;++o)t[o]=n.getInt16(a+2*o,e);return t}function n(r,t,e){var n=new DataView(r.buffer),a=r.byteOffset,i=r.byteLength;t||(t=new Int32Array(i/4));for(var o=0,u=i/4;u>o;++o)t[o]=n.getInt32(a+4*o,e);return t}function a(r,t,e){var n=r.length,a=1/t;e||(e=new Float32Array(n));for(var i=0;n>i;++i)e[i]=r[i]*a;return e}function i(r,t){var e,n;if(!t){var a=0;for(e=0,n=r.length;n>e;e+=2)a+=r[e+1];t=new r.constructor(a)}var i=0;for(e=0,n=r.length;n>e;e+=2)for(var o=r[e],u=r[e+1],c=0;u>c;++c)t[i]=o,i+=1;return t}function o(r){for(var t=1,e=r.length;e>t;++t)r[t]+=r[t-1];return r}function u(r,t,e){var n=r.length/2+t.length;e||(e=new Int32Array(n));for(var a=0,i=0,o=0,u=r.length;u>o;o+=2){var c=r[o],s=r[o+1];e[a]=c,0!==o&&(e[a]+=e[a-1]),a+=1;for(var f=0;s>f;++f)e[a]=e[a-1]+t[i],a+=1,i+=1}return e}function c(r,t,i,o,c){var s;o&&(s=new Int32Array(o.buffer,o.byteOffset,o.byteLength/4));var f=u(n(r,void 0,c),e(t,void 0,c),s);return a(f,i,o)}function s(r,t){for(var e,n=r.resOrder,a=n.byteOffset,i=n.byteLength,o=new DataView(n.buffer),u=0,c=0,s=i/4;s>c;++c)e=o.getInt32(a+4*c,t),u+=r.groupMap[e].bondOrders.length;return u}function f(e){e instanceof ArrayBuffer&&(e=new Uint8Array(e));var a,u,f,_,g=r(e),y=s(g),w=g.numAtoms,b=g.resOrder.length/4,d=g.chainList.length/4,U=g.chainsPerModel.length,h=g.groupMap,v=new Uint32Array(y+b),A=new Uint32Array(y+b),m=new Uint8Array(y+b),I=new Uint32Array(w),p=new Float32Array(w),C=new Float32Array(w),O=new Float32Array(w),x=new Float32Array(w),S=new Int32Array(w),F=new Uint8Array(w),L=new Uint32Array(b),D=new Uint32Array(b),M=new Uint16Array(b),V=new Uint16Array(b),z=new Int32Array(b),P=new Uint8Array(b),G=new Uint16Array(d),k=new Uint32Array(d),q=new Uint32Array(d),B=new Uint8Array(4*d),E=new Uint32Array(U),T=new Uint32Array(U);if(c(g.cartn_x_big,g.cartn_x_small,1e3,p),c(g.cartn_y_big,g.cartn_y_small,1e3,C),c(g.cartn_z_big,g.cartn_z_small,1e3,O),g.b_factor_big&&c(g.b_factor_big,g.b_factor_small,100,x),g._atom_site_id&&o(i(n(g._atom_site_id),S)),g._atom_site_label_alt_id){for(a=0,u=g._atom_site_label_alt_id.length;u>a;a+=2){var j=g._atom_site_label_alt_id[a];"?"===j?g._atom_site_label_alt_id[a]=0:g._atom_site_label_alt_id[a]=g._atom_site_label_alt_id[a].charCodeAt(0),g._atom_site_label_alt_id[a+1]=parseInt(g._atom_site_label_alt_id[a+1])}i(g._atom_site_label_alt_id,F)}t(g.chainList,B);var H,J=g.chainsPerModel,K=0;for(a=0;U>a;++a){for(H=J[a],E[a]=K,T[a]=H,f=0;H>f;++f)G[f+K]=a;K+=H}var N,Q=g.groupsPerChain,R=0;for(a=0;d>a;++a){for(N=Q[a],k[a]=R,q[a]=N,f=0;N>f;++f)L[f+R]=a;R+=N}o(i(n(g._atom_site_auth_seq_id),z));var W=n(g.resOrder,V),X=t(g.secStruct),Y=0,Z=0;for(a=0;b>a;++a){var $=h[W[a]],rr=$.atomInfo,tr=rr.length/2,er=$.bondIndices,nr=$.bondOrders;for(f=0,_=nr.length;_>f;++f)v[Z]=Y+er[2*f],A[Z]=Y+er[2*f+1],m[Z]=nr[f],Z+=1;for(P[a]=(l[X[a]]||"l").charCodeAt(),D[a]=Y,M[a]=tr,f=0;tr>f;++f)I[Y]=a,Y+=1}return{bondStore:{atomIndex1:v,atomIndex2:A,bondOrder:m},atomStore:{groupIndex:I,x:p,y:C,z:O,bfactor:x,serial:S,altloc:F},groupStore:{chainIndex:L,atomOffset:D,atomCount:M,groupTypeId:V,resno:z,sstruc:P},chainStore:{modelIndex:G,groupOffset:k,groupCount:q,chainname:B},modelStore:{chainOffset:E,chainCount:T},groupMap:h,unitCell:g.unitCell,spaceGroup:g.spaceGroup,bondCount:y,atomCount:w,groupCount:b,chainCount:d,modelCount:U}}var l={0:"i",1:"s",2:"h",3:"e",4:"g",5:"b",6:"t",7:"l","-1":""};return f}();