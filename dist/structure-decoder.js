var StructureDecoder=function(){"use strict";function t(t,e){this.offset=e||0,this.buffer=t,this.dataView=new DataView(t.buffer)}function e(e){var r=new t(e),n=r.parse();if(r.offset!==e.length)throw new Error(e.length-r.offset+" trailing bytes");return n}function r(t){var e=t.buffer,r=t.byteOffset,n=t.byteLength;return e.slice(r,r+n)}function n(t,e){return e?e.set(new Int8Array(r(t))):e=new Int8Array(r(t)),e}function o(t,e){var n=r(t),o=new DataView(n),s=n.byteLength;e||(e=new Int16Array(s/2));for(var i=0;s>i;i+=2)e[i/2]=o.getInt16(i,!1);return e}function s(t,e){var n=r(t),o=new DataView(n),s=n.byteLength;e||(e=new Int32Array(s/4));for(var i=0;s>i;i+=4)e[i/4]=o.getInt32(i,!1);return e}function i(t,e,r){var n=t.length;r||(r=new Float32Array(n));for(var o=0;n>o;++o)r[o]=t[o]/e;return r}function a(t,e){if(!e){for(var r=0,n=0,o=t.length;o>n;n+=2)r+=t[n+1];e=new t.constructor(r)}for(var s=0,n=0,o=t.length;o>n;n+=2)for(var i=t[n],a=t[n+1],f=0;a>f;++f)e[s]=i,s+=1;return e}function f(t){for(var e=1,r=t.length;r>e;++e)t[e]+=t[e-1];return t}function h(t,e,r){var n=t.length/2+e.length;r||(r=new Int32Array(n));for(var o=0,s=0,i=0,a=t.length;a>i;i+=2){var f=t[i],h=t[i+1];r[o]=f,0!==i&&(r[o]+=r[o-1]),o+=1;for(var u=0;h>u;++u)r[o]=r[o-1]+e[s],o+=1,s+=1}return r}function u(t,e,r,n){var a=h(s(t),o(e));return i(a,r,n)}function c(t){for(var e=s(t.resOrder),r=0,n=0,o=e.length;o>n;++n)r+=t.groupMap[e[n]].bondOrders.length;return{bondCount:r,atomCount:t.numAtoms,residueCount:t.resOrder.length/4,chainCount:t.chainList.length/4,modelCount:t.chainsPerModel.length}}function d(t,e,r){var o,i,h,d,l,m=(Object({},r),c(t)),g=m.bondCount,b=m.atomCount,_=m.residueCount,v=m.chainCount,y=m.modelCount;e?(o=e.bondStore,i=e.atomStore,h=e.residueStore,d=e.chainStore,l=e.modelStore):(o={atomIndex1:new Uint32Array(g),atomIndex2:new Uint32Array(g),bondOrder:new Uint8Array(g)},i={residueIndex:new Uint32Array(b),x:new Float32Array(b),y:new Float32Array(b),z:new Float32Array(b),bfactor:new Float32Array(b),element:new Uint8Array(3*b),serial:new Int32Array(b),hetero:new Int8Array(b),altloc:new Uint8Array(b),atomname:new Uint32Array(4*b)},h={chainIndex:new Uint32Array(_),atomOffset:new Uint32Array(_),atomCount:new Uint16Array(_),resno:new Int32Array(_),resname:new Uint8Array(5*_),sstruc:new Uint8Array(_)},d={modelIndex:new Uint16Array(v),residueOffset:new Uint32Array(v),residueCount:new Uint32Array(v),chainname:new Uint8Array(4*v)},l={chainOffset:new Uint32Array(y),chainCount:new Uint32Array(y)}),u(t.cartn_x_big,t.cartn_x_small,1e3,i.x),u(t.cartn_y_big,t.cartn_y_small,1e3,i.y),u(t.cartn_z_big,t.cartn_z_small,1e3,i.z),u(t.b_factor_big,t.b_factor_small,100,i.bfactor),f(a(s(t._atom_site_id),i.serial));for(var S=0,C=t._atom_site_label_alt_id.length;C>S;S+=2){var w=t._atom_site_label_alt_id[S];"?"===w?t._atom_site_label_alt_id[S]=0:t._atom_site_label_alt_id[S]=t._atom_site_label_alt_id[S].charCodeAt(0),t._atom_site_label_alt_id[S+1]=parseInt(t._atom_site_label_alt_id[S+1])}a(t._atom_site_label_alt_id,i.altloc),d.chainname.set(n(t.chainList));var p=0;t.chainsPerModel.forEach(function(t,e){l.chainOffset[e]=p,l.chainCount[e]=t;for(var r=0;t>r;++r)d.modelIndex[r+p]=e;p+=t});var U=0;t.groupsPerChain.forEach(function(t,e){d.residueOffset[e]=U,d.residueCount[e]=t;for(var r=0;t>r;++r)h.chainIndex[r+U]=e;U+=t});var A={0:"i",1:"s",2:"h",3:"e",4:"g",5:"b",6:"t",7:"l","-1":""};f(a(s(t._atom_site_auth_seq_id),h.resno));for(var I=s(t.resOrder),x=n(t.secStruct),O=0,M=0,S=0;_>S;++S){for(var F=t.groupMap[I[S]],k=F.hetFlag?1:0,D=F.atomInfo,z=D.length/2,L=F.bondIndices,V=F.bondOrders,B=0,E=V.length;E>B;++B)o.atomIndex1[M]=O+L[2*B],o.atomIndex2[M]=O+L[2*B+1],o.bondOrder[M]=V[B],M+=1;h.sstruc[S]=(A[x[S]]||"l").charCodeAt(),h.atomOffset[S]=O,h.atomCount[S]=z;for(var P=F.resName,B=0,E=P.length;E>B;++B)h.resname[5*S+B]=P.charCodeAt(B);for(var B=0;z>B;++B){for(var R=D[2*B+1],G=0,T=R.length;T>G;++G)i.atomname[4*O+G]=R.charCodeAt(G);for(var j=D[2*B],G=0,T=j.length;T>G;++G)i.element[3*O+G]=j.charCodeAt(G);i.hetero[O]=k,i.residueIndex[O]=S,O+=1}}return{bondStore:o,atomStore:i,residueStore:h,chainStore:d,modelStore:l}}t.prototype.map=function(t){for(var e={},r=0;t>r;r++){var n=this.parse();e[n]=this.parse()}return e},t.prototype.bin=function(t){var e=this.buffer.subarray(this.offset,this.offset+t);return this.offset+=t,e},t.prototype.str=function(t){var e=this.buffer.subarray(this.offset,this.offset+t),r=String.fromCharCode.apply(null,e);return this.offset+=t,r},t.prototype.array=function(t){for(var e=new Array(t),r=0;t>r;r++)e[r]=this.parse();return e},t.prototype.parse=function(){var t,e,r,n=this.dataView,o=this.buffer[this.offset];if(0===(128&o))return this.offset++,o;if(128===(240&o))return e=15&o,this.offset++,this.map(e);if(144===(240&o))return e=15&o,this.offset++,this.array(e);if(160===(224&o))return e=31&o,this.offset++,this.str(e);if(224===(224&o))return t=n.getInt8(this.offset),this.offset++,t;switch(o){case 192:return this.offset++,null;case 194:return this.offset++,!1;case 195:return this.offset++,!0;case 196:return e=n.getUint8(this.offset+1),this.offset+=2,this.bin(e);case 197:return e=n.getUint16(this.offset+1),this.offset+=3,this.bin(e);case 198:return e=n.getUint32(this.offset+1),this.offset+=5,this.bin(e);case 199:return e=n.getUint8(this.offset+1),r=n.getUint8(this.offset+2),this.offset+=3,[r,this.bin(e)];case 200:return e=n.getUint16(this.offset+1),r=n.getUint8(this.offset+3),this.offset+=4,[r,this.bin(e)];case 201:return e=n.getUint32(this.offset+1),r=n.getUint8(this.offset+5),this.offset+=6,[r,this.bin(e)];case 202:return t=n.getFloat32(this.offset+1),this.offset+=5,t;case 203:return t=n.getFloat64(this.offset+1),this.offset+=9,t;case 204:return t=this.buffer[this.offset+1],this.offset+=2,t;case 205:return t=n.getUint16(this.offset+1),this.offset+=3,t;case 206:return t=n.getUint32(this.offset+1),this.offset+=5,t;case 207:return t=n.getUint64(this.offset+1),this.offset+=9,t;case 208:return t=n.getInt8(this.offset+1),this.offset+=2,t;case 209:return t=n.getInt16(this.offset+1),this.offset+=3,t;case 210:return t=n.getInt32(this.offset+1),this.offset+=5,t;case 211:return t=n.getInt64(this.offset+1),this.offset+=9,t;case 212:return r=n.getUint8(this.offset+1),t=n.getUint8(this.offset+2),this.offset+=3,0===r&&0===t?void 0:[r,t];case 213:return r=n.getUint8(this.offset+1),this.offset+=2,[r,this.bin(2)];case 214:return r=n.getUint8(this.offset+1),this.offset+=2,[r,this.bin(4)];case 215:return r=n.getUint8(this.offset+1),this.offset+=2,[r,this.bin(8)];case 216:return r=n.getUint8(this.offset+1),this.offset+=2,[r,this.bin(16)];case 217:return e=n.getUint8(this.offset+1),this.offset+=2,this.str(e);case 218:return e=n.getUint16(this.offset+1),this.offset+=3,this.str(e);case 219:return e=n.getUint32(this.offset+1),this.offset+=5,this.str(e);case 220:return e=n.getUint16(this.offset+1),this.offset+=3,this.array(e);case 221:return e=n.getUint32(this.offset+1),this.offset+=5,this.array(e);case 222:return e=n.getUint16(this.offset+1),this.offset+=3,this.map(e);case 223:return e=n.getUint32(this.offset+1),this.offset+=5,this.map(e);case 216:return e=n.getUint16(this.offset+1),this.offset+=3,this.buf(e);case 217:return e=n.getUint32(this.offset+1),this.offset+=5,this.buf(e)}throw new Error("Unknown type 0x"+o.toString(16))};var l=function(t){function r(t,e){var r=performance.now(),n=d(_,t,e),o=performance.now();g.__structureDecodeTimeMs=o-r,g.bondStore=n.bondStore,g.atomStore=n.atomStore,g.residueStore=n.residueStore,g.chainStore=n.chainStore,g.modelStore=n.modelStore}function n(t){return[g.bondStore.atomIndex1[t],g.bondStore.atomIndex2[t],g.bondStore.bondOrder[t]]}function o(t){for(var e="",r=0;3>r;++r){var n=g.atomStore.element[3*t+r];if(!n)break;e+=String.fromCharCode(n)}for(var o="",r=0;4>r;++r){var n=g.atomStore.atomname[4*t+r];if(!n)break;o+=String.fromCharCode(n)}return[g.atomStore.residueIndex[t],g.atomStore.x[t],g.atomStore.y[t],g.atomStore.z[t],g.atomStore.bfactor[t],e,g.atomStore.serial[t],g.atomStore.hetero[t],String.fromCharCode(g.atomStore.altloc[t]),o]}function s(t){for(var e="",r=0;5>r;++r){var n=g.residueStore.resname[5*t+r];if(!n)break;e+=String.fromCharCode(n)}return[g.residueStore.chainIndex[t],g.residueStore.atomOffset[t],g.residueStore.atomCount[t],g.residueStore.resno[t],e,String.fromCharCode(g.residueStore.sstruc[t])]}function i(t){for(var e="",r=0;4>r;++r){var n=g.chainStore.chainname[4*t+r];if(!n)break;e+=String.fromCharCode(n)}return[g.chainStore.modelIndex[t],g.chainStore.residueOffset[t],g.chainStore.residueCount[t],e]}function a(t){return[g.modelStore.chainOffset[t],g.modelStore.chainCount[t]]}function f(t){for(var e=0;S>e;++e)t.apply(null,g.getBond(e))}function h(t){for(var e=0;C>e;++e)t.apply(null,g.getAtom(e))}function u(t){for(var e=0;w>e;++e)t.apply(null,g.getResidue(e))}function l(t){for(var e=0;p>e;++e)t.apply(null,g.getChain(e))}function m(t){for(var e=0;U>e;++e)t.apply(null,g.getModel(e))}var g=this;t instanceof ArrayBuffer?(g.buffer=t,t=new Uint8Array(t)):g.buffer=t.buffer;var b=performance.now(),_=e(t),v=performance.now();this.__msgpackDecodeTimeMs=v-b;var y=c(_),S=y.bondCount,C=y.atomCount,w=y.residueCount,p=y.chainCount,U=y.modelCount;this.unitCell=_.unitCell,this.spaceGroup=_.spaceGroup,this.bondCount=S,this.atomCount=C,this.residueCount=w,this.chainCount=p,this.modelCount=U,this.bondStore=void 0,this.atomStore=void 0,this.residueStore=void 0,this.chainStore=void 0,this.modelStore=void 0,this.decode=r,this.getBond=n,this.getAtom=o,this.getResidue=s,this.getChain=i,this.getModel=a,this.eachBond=f,this.eachAtom=h,this.eachResidue=u,this.eachChain=l,this.eachModel=m};return l}();