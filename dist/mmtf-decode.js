var decodeMmtf=function(){"use strict";function r(r){function t(r){for(var t={},n=0;r>n;n++){var e=o();t[e]=o()}return t}function n(t){var n=r.subarray(i,i+t);return i+=t,n}function e(t){var n=r.subarray(i,i+t);i+=t;var e=65535;if(t>e){for(var a=[],o=0;o<n.length;o+=e)a.push(String.fromCharCode.apply(null,n.subarray(o,o+e)));return a.join("")}return String.fromCharCode.apply(null,n)}function a(r){for(var t=new Array(r),n=0;r>n;n++)t[n]=o();return t}function o(){var o,s,f,c=r[i];if(0===(128&c))return i++,c;if(128===(240&c))return s=15&c,i++,t(s);if(144===(240&c))return s=15&c,i++,a(s);if(160===(224&c))return s=31&c,i++,e(s);if(224===(224&c))return o=u.getInt8(i),i++,o;switch(c){case 192:return i++,null;case 194:return i++,!1;case 195:return i++,!0;case 196:return s=u.getUint8(i+1),i+=2,n(s);case 197:return s=u.getUint16(i+1),i+=3,n(s);case 198:return s=u.getUint32(i+1),i+=5,n(s);case 199:return s=u.getUint8(i+1),f=u.getUint8(i+2),i+=3,[f,n(s)];case 200:return s=u.getUint16(i+1),f=u.getUint8(i+3),i+=4,[f,n(s)];case 201:return s=u.getUint32(i+1),f=u.getUint8(i+5),i+=6,[f,n(s)];case 202:return o=u.getFloat32(i+1),i+=5,o;case 203:return o=u.getFloat64(i+1),i+=9,o;case 204:return o=r[i+1],i+=2,o;case 205:return o=u.getUint16(i+1),i+=3,o;case 206:return o=u.getUint32(i+1),i+=5,o;case 207:return i+=9,0;case 208:return o=u.getInt8(i+1),i+=2,o;case 209:return o=u.getInt16(i+1),i+=3,o;case 210:return o=u.getInt32(i+1),i+=5,o;case 211:return i+=9,0;case 212:return f=u.getUint8(i+1),i+=2,[f,n(1)];case 213:return f=u.getUint8(i+1),i+=2,[f,n(2)];case 214:return f=u.getUint8(i+1),i+=2,[f,n(4)];case 215:return f=u.getUint8(i+1),i+=2,[f,n(8)];case 216:return f=u.getUint8(i+1),i+=2,[f,n(16)];case 217:return s=u.getUint8(i+1),i+=2,e(s);case 218:return s=u.getUint16(i+1),i+=3,e(s);case 219:return s=u.getUint32(i+1),i+=5,e(s);case 220:return s=u.getUint16(i+1),i+=3,a(s);case 221:return s=u.getUint32(i+1),i+=5,a(s);case 222:return s=u.getUint16(i+1),i+=3,t(s);case 223:return s=u.getUint32(i+1),i+=5,t(s)}throw new Error("Unknown type 0x"+c.toString(16))}var i=0,u=new DataView(r.buffer);return o()}function t(r){return new Uint8Array(r.buffer,r.byteOffset,r.byteLength)}function n(r){return new Int8Array(r.buffer,r.byteOffset,r.byteLength)}function e(r,t,n){var e,a,o,i=r.byteOffset,u=r.byteLength;if(t||(t=new Int16Array(u/2)),n){var s=new DataView(r.buffer);for(e=0,a=0,o=u/2;o>e;++e,a+=2)t[e]=s.getInt16(i+a,n)}else for(e=0,a=0,o=u/2;o>e;++e,a+=2)t[e]=r[a]<<8^r[a+1]<<0;return t}function a(r,t,n){var e,a,o,i=r.byteOffset,u=r.byteLength;if(t||(t=new Int32Array(u/4)),n){var s=new DataView(r.buffer);for(e=0,a=0,o=u/4;o>e;++e,a+=4)t[e]=s.getInt32(i+a,n)}else for(e=0,a=0,o=u/4;o>e;++e,a+=4)t[e]=r[a]<<24^r[a+1]<<16^r[a+2]<<8^r[a+3]<<0;return t}function o(r){return new Int32Array(r.buffer,r.byteOffset,r.byteLength/4)}function i(r,t,n){var e=r.length,a=1/t;n||(n=new Float32Array(e));for(var o=0;e>o;++o)n[o]=r[o]*a;return n}function u(r,t){var n,e;if(!t){var a=0;for(n=0,e=r.length;e>n;n+=2)a+=r[n+1];t=new r.constructor(a)}var o=0;for(n=0,e=r.length;e>n;n+=2)for(var i=r[n],u=r[n+1],s=0;u>s;++s)t[o]=i,o+=1;return t}function s(r){for(var t=1,n=r.length;n>t;++t)r[t]+=r[t-1];return r}function f(r,t,n){var e=r.length/2+t.length;n||(n=new Int32Array(e));for(var a=0,o=0,i=0,u=r.length;u>i;i+=2){var s=r[i],f=r[i+1];n[a]=s,0!==i&&(n[a]+=n[a-1]),a+=1;for(var c=0;f>c;++c)n[a]=n[a-1]+t[o],a+=1,o+=1}return n}function c(r,t,n,u,s){var c=u?o(u):void 0,g=f(a(r,void 0,s),e(t,void 0,s),c);return i(g,n,u)}function g(r,t,n,e){var s=n?o(n):void 0,f=u(a(r,void 0,e),s);return i(f,t,n)}function d(e,o){e instanceof ArrayBuffer&&(e=new Uint8Array(e));var i;i=e instanceof Uint8Array?r(e):e,void 0===i.chainIdList&&(i.chainIdList=i.chainList,i.groupIdList=i.groupNumList);var f,d,l,y,v=i.numBonds||0,h=i.numAtoms||0,w=i.groupTypeList.length/4,U=i.chainIdList.length/4,b=i.chainsPerModel.length,A=i.groupMap,p=new Uint32Array(v+w),I=new Uint32Array(v+w),m=new Uint8Array(v+w),L=new Uint32Array(h),C=new Float32Array(h),S=new Float32Array(h),F=new Float32Array(h),O=new Float32Array(h),x=new Int32Array(h),B=new Uint8Array(h),M=new Uint8Array(h),z=new Float32Array(h),D=new Uint32Array(w),G=new Uint32Array(w),P=new Uint16Array(w),T=new Uint16Array(w),V=new Int32Array(w),N=n(i.secStructList),j=new Uint16Array(U),k=new Uint32Array(U),E=new Uint32Array(U),q=t(i.chainIdList),H=new Uint32Array(b),J=new Uint32Array(b);if(c(i.xCoordBig,i.xCoordSmall,1e3,C,o),c(i.yCoordBig,i.yCoordSmall,1e3,S,o),c(i.zCoordBig,i.zCoordSmall,1e3,F,o),i.bFactorBig&&i.bFactorSmall&&c(i.bFactorBig,i.bFactorSmall,100,O,o),i.atomIdList&&s(u(a(i.atomIdList,void 0,o),x)),i.altLabelList){var K=i.altLabelList;for(f=0,d=K.length;d>f;f+=2){var Q=K[f];"?"===Q?K[f]=0:K[f]=Q.charCodeAt(0),K[f+1]=parseInt(K[f+1])}u(K,B)}if(i.insCodeList){var R=i.insCodeList;for(f=0,d=R.length;d>f;f+=2){var W=R[f];null===W?R[f]=0:R[f]=W.charCodeAt(0),R[f+1]=parseInt(R[f+1])}u(R,M)}i.occList&&g(i.occList,100,z,o);var X,Y=i.chainsPerModel,Z=0;for(f=0;b>f;++f){for(X=Y[f],H[f]=Z,J[f]=X,l=0;X>l;++l)j[l+Z]=f;Z+=X}var $,_=i.groupsPerChain,rr=0;for(f=0;U>f;++f){for($=_[f],k[f]=rr,E[f]=$,l=0;$>l;++l)D[l+rr]=f;rr+=$}s(u(a(i.groupIdList,void 0,o),V)),a(i.groupTypeList,T,o);var tr=0,nr=0;for(f=0;w>f;++f){var er=A[T[f]],ar=er.atomInfo,or=ar.length/2,ir=er.bondIndices,ur=er.bondOrders;for(l=0,y=ur.length;y>l;++l)p[nr]=tr+ir[2*l],I[nr]=tr+ir[2*l+1],m[nr]=ur[l],nr+=1;for(G[f]=tr,P[f]=or,l=0;or>l;++l)L[tr]=f,tr+=1}if(i.bondAtomList){if(i.bondOrderList){var sr=i.bondOrderList;m.set(sr,nr)}var fr=a(i.bondAtomList,void 0,o);for(f=0,d=fr.length;d>f;f+=2)p[nr]=fr[f],I[nr]=fr[f+1],nr+=1}return{bondStore:{atomIndex1:p,atomIndex2:I,bondOrder:m},atomStore:{groupIndex:L,xCoord:C,yCoord:S,zCoord:F,bFactor:O,atomId:x,altLabel:B,insCode:M,occupancy:z},groupStore:{chainIndex:D,atomOffset:G,atomCount:P,groupTypeId:T,groupId:V,secStruct:N},chainStore:{modelIndex:j,groupOffset:k,groupCount:E,chainName:q},modelStore:{chainOffset:H,chainCount:J},groupMap:A,unitCell:i.unitCell,spaceGroup:i.spaceGroup,bioAssembly:i.bioAssembly,pdbId:i.pdbId,title:i.title,numBonds:v,numAtoms:h,numGroups:w,numChains:U,numModels:b}}return d}();