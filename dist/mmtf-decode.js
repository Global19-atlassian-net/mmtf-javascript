var decodeMmtf=function(){"use strict";function r(r){function t(r){for(var t={},n=0;r>n;n++){var e=o();t[e]=o()}return t}function n(t){var n=r.subarray(i,i+t);return i+=t,n}function e(t){var n=r.subarray(i,i+t),e=String.fromCharCode.apply(null,n);return i+=t,e}function a(r){for(var t=new Array(r),n=0;r>n;n++)t[n]=o();return t}function o(){var o,s,c,f=r[i];if(0===(128&f))return i++,f;if(128===(240&f))return s=15&f,i++,t(s);if(144===(240&f))return s=15&f,i++,a(s);if(160===(224&f))return s=31&f,i++,e(s);if(224===(224&f))return o=u.getInt8(i),i++,o;switch(f){case 192:return i++,null;case 194:return i++,!1;case 195:return i++,!0;case 196:return s=u.getUint8(i+1),i+=2,n(s);case 197:return s=u.getUint16(i+1),i+=3,n(s);case 198:return s=u.getUint32(i+1),i+=5,n(s);case 199:return s=u.getUint8(i+1),c=u.getUint8(i+2),i+=3,[c,n(s)];case 200:return s=u.getUint16(i+1),c=u.getUint8(i+3),i+=4,[c,n(s)];case 201:return s=u.getUint32(i+1),c=u.getUint8(i+5),i+=6,[c,n(s)];case 202:return o=u.getFloat32(i+1),i+=5,o;case 203:return o=u.getFloat64(i+1),i+=9,o;case 204:return o=r[i+1],i+=2,o;case 205:return o=u.getUint16(i+1),i+=3,o;case 206:return o=u.getUint32(i+1),i+=5,o;case 207:return i+=9,0;case 208:return o=u.getInt8(i+1),i+=2,o;case 209:return o=u.getInt16(i+1),i+=3,o;case 210:return o=u.getInt32(i+1),i+=5,o;case 211:return i+=9,0;case 212:return c=u.getUint8(i+1),i+=2,[c,n(1)];case 213:return c=u.getUint8(i+1),i+=2,[c,n(2)];case 214:return c=u.getUint8(i+1),i+=2,[c,n(4)];case 215:return c=u.getUint8(i+1),i+=2,[c,n(8)];case 216:return c=u.getUint8(i+1),i+=2,[c,n(16)];case 217:return s=u.getUint8(i+1),i+=2,e(s);case 218:return s=u.getUint16(i+1),i+=3,e(s);case 219:return s=u.getUint32(i+1),i+=5,e(s);case 220:return s=u.getUint16(i+1),i+=3,a(s);case 221:return s=u.getUint32(i+1),i+=5,a(s);case 222:return s=u.getUint16(i+1),i+=3,t(s);case 223:return s=u.getUint32(i+1),i+=5,t(s)}throw new Error("Unknown type 0x"+f.toString(16))}var i=0,u=new DataView(r.buffer);return o()}function t(r){return new Uint8Array(r.buffer,r.byteOffset,r.byteLength)}function n(r){return new Int8Array(r.buffer,r.byteOffset,r.byteLength)}function e(r,t,n){var e=r.byteOffset,a=r.byteLength;if(t||(t=new Int16Array(a/2)),n)for(var o=new DataView(r.buffer),i=0,u=0,s=a/2;s>i;++i,u+=2)t[i]=o.getInt16(e+u,n);else for(var i=0,u=0,s=a/2;s>i;++i,u+=2)t[i]=r[u]<<8^r[u+1]<<0;return t}function a(r,t,n){var e=r.byteOffset,a=r.byteLength;if(t||(t=new Int32Array(a/4)),n)for(var o=new DataView(r.buffer),i=0,u=0,s=a/4;s>i;++i,u+=4)t[i]=o.getInt32(e+u,n);else for(var i=0,u=0,s=a/4;s>i;++i,u+=4)t[i]=r[u]<<24^r[u+1]<<16^r[u+2]<<8^r[u+3]<<0;return t}function o(r){return new Int32Array(r.buffer,r.byteOffset,r.byteLength/4)}function i(r,t,n){var e=r.length,a=1/t;n||(n=new Float32Array(e));for(var o=0;e>o;++o)n[o]=r[o]*a;return n}function u(r,t){var n,e;if(!t){var a=0;for(n=0,e=r.length;e>n;n+=2)a+=r[n+1];t=new r.constructor(a)}var o=0;for(n=0,e=r.length;e>n;n+=2)for(var i=r[n],u=r[n+1],s=0;u>s;++s)t[o]=i,o+=1;return t}function s(r){for(var t=1,n=r.length;n>t;++t)r[t]+=r[t-1];return r}function c(r,t,n){var e=r.length/2+t.length;n||(n=new Int32Array(e));for(var a=0,o=0,i=0,u=r.length;u>i;i+=2){var s=r[i],c=r[i+1];n[a]=s,0!==i&&(n[a]+=n[a-1]),a+=1;for(var f=0;c>f;++f)n[a]=n[a-1]+t[o],a+=1,o+=1}return n}function f(r,t,n,u,s){var f=u?o(u):void 0,g=c(a(r,void 0,s),e(t,void 0,s),f);return i(g,n,u)}function g(r,t,n,e){var s=n?o(n):void 0,c=u(a(r,void 0,e),s);return i(c,t,n)}function d(e,o){e instanceof ArrayBuffer&&(e=new Uint8Array(e));var i;i=e instanceof Uint8Array?r(e):e,void 0===i.chainIdList&&(i.chainIdList=i.chainList,i.groupIdList=i.groupNumList);var c,d,l,y,v=i.numBonds||0,w=i.numAtoms||0,U=i.groupTypeList.length/4,A=i.chainIdList.length/4,b=i.chainsPerModel.length,h=i.groupMap,I=new Uint32Array(v+U),m=new Uint32Array(v+U),p=new Uint8Array(v+U),L=new Uint32Array(w),C=new Float32Array(w),S=new Float32Array(w),F=new Float32Array(w),O=new Float32Array(w),x=new Int32Array(w),B=new Uint8Array(w),M=new Uint8Array(w),z=new Float32Array(w),D=new Uint32Array(U),G=new Uint32Array(U),P=new Uint16Array(U),T=new Uint16Array(U),V=new Int32Array(U),N=n(i.secStructList),k=new Uint16Array(A),E=new Uint32Array(A),j=new Uint32Array(A),q=t(i.chainIdList),H=new Uint32Array(b),J=new Uint32Array(b);if(f(i.xCoordBig,i.xCoordSmall,1e3,C,o),f(i.yCoordBig,i.yCoordSmall,1e3,S,o),f(i.zCoordBig,i.zCoordSmall,1e3,F,o),i.bFactorBig&&i.bFactorSmall&&f(i.bFactorBig,i.bFactorSmall,100,O,o),i.atomIdList&&s(u(a(i.atomIdList,void 0,o),x)),i.altLabelList){var K=i.altLabelList;for(c=0,d=K.length;d>c;c+=2){var Q=K[c];"?"===Q?K[c]=0:K[c]=K[c].charCodeAt(0),K[c+1]=parseInt(K[c+1])}u(K,B)}if(i.insCodeList){var R=i.insCodeList;for(c=0,d=R.length;d>c;c+=2){var Q=R[c];null===Q?R[c]=0:R[c]=R[c].charCodeAt(0),R[c+1]=parseInt(R[c+1])}u(R,M)}i.occList&&g(i.occList,100,z,o);var W,X=i.chainsPerModel,Y=0;for(c=0;b>c;++c){for(W=X[c],H[c]=Y,J[c]=W,l=0;W>l;++l)k[l+Y]=c;Y+=W}var Z,$=i.groupsPerChain,_=0;for(c=0;A>c;++c){for(Z=$[c],E[c]=_,j[c]=Z,l=0;Z>l;++l)D[l+_]=c;_+=Z}s(u(a(i.groupIdList,void 0,o),V)),a(i.groupTypeList,T,o);var rr=0,tr=0;for(c=0;U>c;++c){var nr=h[T[c]],er=nr.atomInfo,ar=er.length/2,or=nr.bondIndices,ir=nr.bondOrders;for(l=0,y=ir.length;y>l;++l)I[tr]=rr+or[2*l],m[tr]=rr+or[2*l+1],p[tr]=ir[l],tr+=1;for(G[c]=rr,P[c]=ar,l=0;ar>l;++l)L[rr]=c,rr+=1}if(i.bondAtomList){if(i.bondOrderList){var ur=i.bondOrderList;p.set(ur,tr)}var sr=a(i.bondAtomList,void 0,o);for(c=0,d=sr.length;d>c;c+=2)I[tr]=sr[c],m[tr]=sr[c+1],tr+=1}return{bondStore:{atomIndex1:I,atomIndex2:m,bondOrder:p},atomStore:{groupIndex:L,xCoord:C,yCoord:S,zCoord:F,bFactor:O,atomId:x,altLabel:B,insCode:M,occupancy:z},groupStore:{chainIndex:D,atomOffset:G,atomCount:P,groupTypeId:T,groupId:V,secStruct:N},chainStore:{modelIndex:k,groupOffset:E,groupCount:j,chainName:q},modelStore:{chainOffset:H,chainCount:J},groupMap:h,unitCell:i.unitCell,spaceGroup:i.spaceGroup,bioAssembly:i.bioAssembly,pdbId:i.pdbId,title:i.title,numBonds:v,numAtoms:w,numGroups:U,numChains:A,numModels:b}}return d}();