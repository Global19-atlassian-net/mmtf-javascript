!function(n,r){"object"==typeof exports&&"undefined"!=typeof module?module.exports=r():"function"==typeof define&&define.amd?define(r):n.decodeMmtf=r()}(this,function(){"use strict";function n(n,r,t){return r?new n(r.buffer,r.byteOffset,r.byteLength/(t||1)):void 0}function r(r){return n(DataView,r)}function t(r){return n(Uint8Array,r)}function e(r){return n(Int8Array,r)}function o(r){return n(Int32Array,r,4)}function u(r){return n(Float32Array,r,4)}function i(n,r){var t=n.length/2;r||(r=new Int16Array(t));for(var e=0,o=0;t>e;++e,o+=2)r[e]=n[o]<<8^n[o+1]<<0;return r}function f(n,r){var t=n.length/4;r||(r=new Int32Array(t));for(var e=0,o=0;t>e;++e,o+=4)r[e]=n[o]<<24^n[o+1]<<16^n[o+2]<<8^n[o+3]<<0;return r}function a(n,t){var e=n.length;t||(t=new Float32Array(e/4));for(var o=r(t),u=r(n),i=0,f=0,a=e/4;a>i;++i,f+=4)o.setFloat32(f,u.getFloat32(f),!0);return t}function c(n,r,t){var e=n.length,o=1/r;t||(t=new Float32Array(e));for(var u=0;e>u;++u)t[u]=n[u]*o;return t}function s(n,r){var t,e;if(!r){var o=0;for(t=0,e=n.length;e>t;t+=2)o+=n[t+1];r=new n.constructor(o)}var u=0;for(t=0,e=n.length;e>t;t+=2)for(var i=n[t],f=n[t+1],a=0;f>a;++a)r[u]=i,u+=1;return r}function d(n,r){var t=n.length;r||(r=new n.constructor(t)),t&&(r[0]=n[0]);for(var e=1;t>e;++e)r[e]=n[e]+r[e-1];return r}function l(n,r){var t=n instanceof Int8Array?127:32767,e=-t-1,o=n.length;r||(r=new Int32Array(o));for(var u=0,i=0;o>u;){for(var f=0;(n[u]===t||n[u]===e)&&(f+=n[u],u+=1,0!==n[u]););f+=n[u],u+=1,r[i]=f,i+=1}return new r.constructor(r.buffer,r.byteOffset,i)}function v(n,r){return d(s(n),r)}function y(n,r,t){return c(s(n,o(t)),r,t)}function L(n,r,t){return c(d(n,o(t)),r,t)}function m(n,r,t){return c(l(n,o(t)),r,t)}function g(n,r,t){var e=l(n,o(t));return L(e,r,u(e))}function h(n){var t=r(n),e=t.getInt32(0),o=t.getInt32(4),u=n.subarray(8,12),n=n.subarray(12);return[e,n,o,u]}function p(n,r){r=r||{};var t=r.ignoreFields,e={};return I.forEach(function(r){var o=t?-1!==t.indexOf(r):!1,u=n[r];if(!o&&void 0!==u)if(u instanceof Uint8Array){var i=h(u);e[r]=w[i[0]](i[1],i[2],i[3])}else e[r]=u}),e}var A=["mmtfVersion","mmtfProducer","unitCell","spaceGroup","structureId","title","depositionDate","releaseDate","experimentalMethods","resolution","rFree","rWork","bioAssemblyList","entityList","groupList","numBonds","numAtoms","numGroups","numChains","numModels","groupsPerChain","chainsPerModel"],b=["xCoordList","yCoordList","zCoordList","groupIdList","groupTypeList","chainIdList","bFactorList","atomIdList","altLocList","occupancyList","secStructList","insCodeList","sequenceIndexList","chainNameList","bondAtomList","bondOrderList"],I=A.concat(b),w={1:function(n,r){return a(n)},2:function(n,r){return e(n)},3:function(n,r){return i(n)},4:function(n,r){return f(n)},5:function(n,r,e){return t(n)},6:function(n,r){return s(f(n),new Uint8Array(r))},7:function(n,r){return s(f(n))},8:function(n,r){return v(f(n))},9:function(n,r,t){return y(f(n),f(t)[0])},10:function(n,r,t){return g(i(n),f(t)[0])},11:function(n,r,t){return c(i(n),f(t)[0])},12:function(n,r,t){return m(i(n),f(t)[0])},13:function(n,r,t){return m(e(n),f(t)[0])}};return p});