var decodeMmtf=function(){"use strict";function r(r){function t(r){for(var t={},n=0;r>n;n++){var e=i();t[e]=i()}return t}function n(t){var n=r.subarray(o,o+t);return o+=t,n}function e(t){var n=r.subarray(o,o+t);o+=t;var e=65535;if(t>e){for(var a=[],i=0;i<n.length;i+=e)a.push(String.fromCharCode.apply(null,n.subarray(i,i+e)));return a.join("")}return String.fromCharCode.apply(null,n)}function a(r){for(var t=new Array(r),n=0;r>n;n++)t[n]=i();return t}function i(){var i,s,c,f=r[o];if(0===(128&f))return o++,f;if(128===(240&f))return s=15&f,o++,t(s);if(144===(240&f))return s=15&f,o++,a(s);if(160===(224&f))return s=31&f,o++,e(s);if(224===(224&f))return i=u.getInt8(o),o++,i;switch(f){case 192:return o++,null;case 194:return o++,!1;case 195:return o++,!0;case 196:return s=u.getUint8(o+1),o+=2,n(s);case 197:return s=u.getUint16(o+1),o+=3,n(s);case 198:return s=u.getUint32(o+1),o+=5,n(s);case 199:return s=u.getUint8(o+1),c=u.getUint8(o+2),o+=3,[c,n(s)];case 200:return s=u.getUint16(o+1),c=u.getUint8(o+3),o+=4,[c,n(s)];case 201:return s=u.getUint32(o+1),c=u.getUint8(o+5),o+=6,[c,n(s)];case 202:return i=u.getFloat32(o+1),o+=5,i;case 203:return i=u.getFloat64(o+1),o+=9,i;case 204:return i=r[o+1],o+=2,i;case 205:return i=u.getUint16(o+1),o+=3,i;case 206:return i=u.getUint32(o+1),o+=5,i;case 207:return o+=9,0;case 208:return i=u.getInt8(o+1),o+=2,i;case 209:return i=u.getInt16(o+1),o+=3,i;case 210:return i=u.getInt32(o+1),o+=5,i;case 211:return o+=9,0;case 212:return c=u.getUint8(o+1),o+=2,[c,n(1)];case 213:return c=u.getUint8(o+1),o+=2,[c,n(2)];case 214:return c=u.getUint8(o+1),o+=2,[c,n(4)];case 215:return c=u.getUint8(o+1),o+=2,[c,n(8)];case 216:return c=u.getUint8(o+1),o+=2,[c,n(16)];case 217:return s=u.getUint8(o+1),o+=2,e(s);case 218:return s=u.getUint16(o+1),o+=3,e(s);case 219:return s=u.getUint32(o+1),o+=5,e(s);case 220:return s=u.getUint16(o+1),o+=3,a(s);case 221:return s=u.getUint32(o+1),o+=5,a(s);case 222:return s=u.getUint16(o+1),o+=3,t(s);case 223:return s=u.getUint32(o+1),o+=5,t(s)}throw new Error("Unknown type 0x"+f.toString(16))}var o=0,u=new DataView(r.buffer);return i()}function t(r){return new Uint8Array(r.buffer,r.byteOffset,r.byteLength)}function n(r){return new Int8Array(r.buffer,r.byteOffset,r.byteLength)}function e(r,t,n){var e,a,i,o=r.byteOffset,u=r.byteLength;if(t||(t=new Int16Array(u/2)),n){var s=new DataView(r.buffer);for(e=0,a=0,i=u/2;i>e;++e,a+=2)t[e]=s.getInt16(o+a,n)}else for(e=0,a=0,i=u/2;i>e;++e,a+=2)t[e]=r[a]<<8^r[a+1]<<0;return t}function a(r,t,n){var e,a,i,o=r.byteOffset,u=r.byteLength;if(t||(t=new Int32Array(u/4)),n){var s=new DataView(r.buffer);for(e=0,a=0,i=u/4;i>e;++e,a+=4)t[e]=s.getInt32(o+a,n)}else for(e=0,a=0,i=u/4;i>e;++e,a+=4)t[e]=r[a]<<24^r[a+1]<<16^r[a+2]<<8^r[a+3]<<0;return t}function i(r){return new Int32Array(r.buffer,r.byteOffset,r.byteLength/4)}function o(r,t,n){var e=r.length,a=1/t;n||(n=new Float32Array(e));for(var i=0;e>i;++i)n[i]=r[i]*a;return n}function u(r,t){var n,e;if(!t){var a=0;for(n=0,e=r.length;e>n;n+=2)a+=r[n+1];t=new r.constructor(a)}var i=0;for(n=0,e=r.length;e>n;n+=2)for(var o=r[n],u=r[n+1],s=0;u>s;++s)t[i]=o,i+=1;return t}function s(r){for(var t=1,n=r.length;n>t;++t)r[t]+=r[t-1];return r}function c(r,t,n){var e=r.length/2+t.length;n||(n=new Int32Array(e));for(var a=0,i=0,o=0,u=r.length;u>o;o+=2){var s=r[o],c=r[o+1];n[a]=s,0!==o&&(n[a]+=n[a-1]),a+=1;for(var f=0;c>f;++f)n[a]=n[a-1]+t[i],a+=1,i+=1}return n}function f(r,t,n,u,s){var f=u?i(u):void 0,d=c(a(r,void 0,s),e(t,void 0,s),f);return o(d,n,u)}function d(r,t,n,e){var s=n?i(n):void 0,c=u(a(r,void 0,e),s);return o(c,t,n)}function g(e,i){i=i||{};var o=i.littleEndian,c=i.ignoreFields||[];e instanceof ArrayBuffer&&(e=new Uint8Array(e));var g;g=e instanceof Uint8Array?r(e):e,void 0===g.chainIdList&&void 0!==g.chainList&&(g.chainIdList=g.chainList,g.groupIdList=g.groupNumList);var l,y,v,h,b=g.bFactorBig&&g.bFactorSmall&&-1===c.indexOf("bFactor"),w=g.atomIdList&&-1===c.indexOf("atomId"),U=g.altLabelList&&-1===c.indexOf("altLabel"),A=g.insCodeList&&-1===c.indexOf("insCode"),m=g.occList&&-1===c.indexOf("occupancy"),I=g.secStructList&&-1===c.indexOf("secStruct"),p=g.chainNameList&&-1===c.indexOf("chainName"),L=g.numBonds||0,C=g.numAtoms||0,O=g.groupTypeList.length/4,S=g.chainIdList.length/4,x=g.chainsPerModel.length,F=g.groupMap,B=new Uint32Array(L+O),M=new Uint32Array(L+O),N=new Uint8Array(L+O),z=new Uint32Array(C),D=new Float32Array(C),G=new Float32Array(C),P=new Float32Array(C),T=b?new Float32Array(C):void 0,V=w?new Int32Array(C):void 0,E=U?new Uint8Array(C):void 0,j=A?new Uint8Array(C):void 0,k=m?new Float32Array(C):void 0,q=new Uint32Array(O),H=new Uint32Array(O),J=new Uint16Array(O),K=new Uint16Array(O),Q=new Int32Array(O),R=I?n(g.secStructList):void 0,W=new Uint16Array(S),X=new Uint32Array(S),Y=new Uint32Array(S),Z=t(g.chainIdList),$=p?t(g.chainNameList):void 0,_=new Uint32Array(x),rr=new Uint32Array(x);if(f(g.xCoordBig,g.xCoordSmall,1e3,D,o),f(g.yCoordBig,g.yCoordSmall,1e3,G,o),f(g.zCoordBig,g.zCoordSmall,1e3,P,o),b&&f(g.bFactorBig,g.bFactorSmall,100,T,o),w&&s(u(a(g.atomIdList,void 0,o),V)),U){var tr=g.altLabelList;for(l=0,y=tr.length;y>l;l+=2){var nr=tr[l];"?"===nr?tr[l]=0:tr[l]=nr.charCodeAt(0),tr[l+1]=parseInt(tr[l+1])}u(tr,E)}if(A){var er=g.insCodeList;for(l=0,y=er.length;y>l;l+=2){var ar=er[l];null===ar?er[l]=0:er[l]=ar.charCodeAt(0),er[l+1]=parseInt(er[l+1])}u(er,j)}m&&d(g.occList,100,k,o);var ir,or=g.chainsPerModel,ur=0;for(l=0;x>l;++l){for(ir=or[l],_[l]=ur,rr[l]=ir,v=0;ir>v;++v)W[v+ur]=l;ur+=ir}var sr,cr=g.groupsPerChain,fr=0;for(l=0;S>l;++l){for(sr=cr[l],X[l]=fr,Y[l]=sr,v=0;sr>v;++v)q[v+fr]=l;fr+=sr}s(u(a(g.groupIdList,void 0,o),Q)),a(g.groupTypeList,K,o);var dr=0,gr=0;for(l=0;O>l;++l){var lr=F[K[l]],yr=lr.atomInfo,vr=yr.length/2,hr=lr.bondIndices,br=lr.bondOrders;for(v=0,h=br.length;h>v;++v)B[gr]=dr+hr[2*v],M[gr]=dr+hr[2*v+1],N[gr]=br[v],gr+=1;for(H[l]=dr,J[l]=vr,v=0;vr>v;++v)z[dr]=l,dr+=1}if(g.bondAtomList){if(g.bondOrderList){var wr=g.bondOrderList;N.set(wr,gr)}var Ur=a(g.bondAtomList,void 0,o);for(l=0,y=Ur.length;y>l;l+=2)B[gr]=Ur[l],M[gr]=Ur[l+1],gr+=1}return{bondStore:{atomIndex1:B,atomIndex2:M,bondOrder:N},atomStore:{groupIndex:z,xCoord:D,yCoord:G,zCoord:P,bFactor:T,atomId:V,altLabel:E,insCode:j,occupancy:k},groupStore:{chainIndex:q,atomOffset:H,atomCount:J,groupTypeId:K,groupId:Q,secStruct:R},chainStore:{modelIndex:W,groupOffset:X,groupCount:Y,chainId:Z,chainName:$},modelStore:{chainOffset:_,chainCount:rr},groupMap:F,unitCell:g.unitCell,spaceGroup:g.spaceGroup,bioAssembly:g.bioAssembly,pdbId:g.pdbId,title:g.title,numBonds:L,numAtoms:C,numGroups:O,numChains:S,numModels:x}}return g}();