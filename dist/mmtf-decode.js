var decodeMmtf=function(){"use strict";function r(r){function t(r){for(var t={},n=0;r>n;n++){var e=o();t[e]=o()}return t}function n(t){var n=r.subarray(i,i+t);return i+=t,n}function e(t){var n=r.subarray(i,i+t),e=String.fromCharCode.apply(null,n);return i+=t,e}function a(r){for(var t=new Array(r),n=0;r>n;n++)t[n]=o();return t}function o(){var o,s,f,c=r[i];if(0===(128&c))return i++,c;if(128===(240&c))return s=15&c,i++,t(s);if(144===(240&c))return s=15&c,i++,a(s);if(160===(224&c))return s=31&c,i++,e(s);if(224===(224&c))return o=u.getInt8(i),i++,o;switch(c){case 192:return i++,null;case 194:return i++,!1;case 195:return i++,!0;case 196:return s=u.getUint8(i+1),i+=2,n(s);case 197:return s=u.getUint16(i+1),i+=3,n(s);case 198:return s=u.getUint32(i+1),i+=5,n(s);case 199:return s=u.getUint8(i+1),f=u.getUint8(i+2),i+=3,[f,n(s)];case 200:return s=u.getUint16(i+1),f=u.getUint8(i+3),i+=4,[f,n(s)];case 201:return s=u.getUint32(i+1),f=u.getUint8(i+5),i+=6,[f,n(s)];case 202:return o=u.getFloat32(i+1),i+=5,o;case 203:return o=u.getFloat64(i+1),i+=9,o;case 204:return o=r[i+1],i+=2,o;case 205:return o=u.getUint16(i+1),i+=3,o;case 206:return o=u.getUint32(i+1),i+=5,o;case 207:return i+=9,0;case 208:return o=u.getInt8(i+1),i+=2,o;case 209:return o=u.getInt16(i+1),i+=3,o;case 210:return o=u.getInt32(i+1),i+=5,o;case 211:return i+=9,0;case 212:return f=u.getUint8(i+1),i+=2,[f,n(1)];case 213:return f=u.getUint8(i+1),i+=2,[f,n(2)];case 214:return f=u.getUint8(i+1),i+=2,[f,n(4)];case 215:return f=u.getUint8(i+1),i+=2,[f,n(8)];case 216:return f=u.getUint8(i+1),i+=2,[f,n(16)];case 217:return s=u.getUint8(i+1),i+=2,e(s);case 218:return s=u.getUint16(i+1),i+=3,e(s);case 219:return s=u.getUint32(i+1),i+=5,e(s);case 220:return s=u.getUint16(i+1),i+=3,a(s);case 221:return s=u.getUint32(i+1),i+=5,a(s);case 222:return s=u.getUint16(i+1),i+=3,t(s);case 223:return s=u.getUint32(i+1),i+=5,t(s)}throw new Error("Unknown type 0x"+c.toString(16))}var i=0,u=new DataView(r.buffer);return o()}function t(r){return new Uint8Array(r.buffer,r.byteOffset,r.byteLength)}function n(r){return new Int8Array(r.buffer,r.byteOffset,r.byteLength)}function e(r,t,n){var e=r.byteOffset,a=r.byteLength;if(t||(t=new Int16Array(a/2)),n)for(var o=new DataView(r.buffer),i=0,u=0,s=a/2;s>i;++i,u+=2)t[i]=o.getInt16(e+u,n);else for(var i=0,u=0,s=a/2;s>i;++i,u+=2)t[i]=r[u]<<8^r[u+1]<<0;return t}function a(r,t,n){var e=r.byteOffset,a=r.byteLength;if(t||(t=new Int32Array(a/4)),n)for(var o=new DataView(r.buffer),i=0,u=0,s=a/4;s>i;++i,u+=4)t[i]=o.getInt32(e+u,n);else for(var i=0,u=0,s=a/4;s>i;++i,u+=4)t[i]=r[u]<<24^r[u+1]<<16^r[u+2]<<8^r[u+3]<<0;return t}function o(r){return new Int32Array(r.buffer,r.byteOffset,r.byteLength/4)}function i(r,t,n){var e=r.length,a=1/t;n||(n=new Float32Array(e));for(var o=0;e>o;++o)n[o]=r[o]*a;return n}function u(r,t){var n,e;if(!t){var a=0;for(n=0,e=r.length;e>n;n+=2)a+=r[n+1];t=new r.constructor(a)}var o=0;for(n=0,e=r.length;e>n;n+=2)for(var i=r[n],u=r[n+1],s=0;u>s;++s)t[o]=i,o+=1;return t}function s(r){for(var t=1,n=r.length;n>t;++t)r[t]+=r[t-1];return r}function f(r,t,n){var e=r.length/2+t.length;n||(n=new Int32Array(e));for(var a=0,o=0,i=0,u=r.length;u>i;i+=2){var s=r[i],f=r[i+1];n[a]=s,0!==i&&(n[a]+=n[a-1]),a+=1;for(var c=0;f>c;++c)n[a]=n[a-1]+t[o],a+=1,o+=1}return n}function c(r,t,n,u,s){var c=u?o(u):void 0,l=f(a(r,void 0,s),e(t,void 0,s),c);return i(l,n,u)}function l(r,t,n,e){var s=n?o(n):void 0,f=u(a(r,void 0,e),s);return i(f,t,n)}function g(e,o){e instanceof ArrayBuffer&&(e=new Uint8Array(e));var i;i=e instanceof Uint8Array?r(e):e,void 0===i.internalChainsPerModel&&(i.internalGroupsPerChain=i.groupsPerChain,i.internalChainsPerModel=i.chainsPerModel,i.internalChainList=i.chainList);var f,g,d,y,v=i.numBonds||0,h=i.numAtoms||0,w=i.groupTypeList.length/4,U=i.chainList.length/4,A=i.internalChainsPerModel.length,b=i.groupMap,m=new Uint32Array(v+w),p=new Uint32Array(v+w),C=new Uint8Array(v+w),I=new Uint32Array(h),L=new Float32Array(h),S=new Float32Array(h),F=new Float32Array(h),O=new Float32Array(h),x=new Int32Array(h),M=new Uint8Array(h),B=new Uint8Array(h),P=new Float32Array(h),G=new Uint32Array(w),z=new Uint32Array(w),D=new Uint16Array(w),N=new Uint16Array(w),T=new Int32Array(w),V=n(i.secStructList),k=new Uint16Array(U),E=new Uint32Array(U),j=new Uint32Array(U),q=t(i.internalChainList),H=new Uint32Array(A),J=new Uint32Array(A);if(c(i.xCoordBig,i.xCoordSmall,1e3,L,o),c(i.yCoordBig,i.yCoordSmall,1e3,S,o),c(i.zCoordBig,i.zCoordSmall,1e3,F,o),i.bFactorBig&&i.bFactorSmall&&c(i.bFactorBig,i.bFactorSmall,100,O,o),i.atomIdList&&s(u(a(i.atomIdList,void 0,o),x)),i.altLabelList){var K=i.altLabelList;for(f=0,g=K.length;g>f;f+=2){var Q=K[f];"?"===Q?K[f]=0:K[f]=K[f].charCodeAt(0),K[f+1]=parseInt(K[f+1])}u(K,M)}if(i.insCodeList){var R=i.insCodeList;for(f=0,g=R.length;g>f;f+=2){var Q=R[f];null===Q?R[f]=0:R[f]=R[f].charCodeAt(0),R[f+1]=parseInt(R[f+1])}u(R,B)}i.occList&&l(i.occList,100,P,o);var W,X=i.internalChainsPerModel,Y=0;for(f=0;A>f;++f){for(W=X[f],H[f]=Y,J[f]=W,d=0;W>d;++d)k[d+Y]=f;Y+=W}var Z,$=i.internalGroupsPerChain,_=0;for(f=0;U>f;++f){for(Z=$[f],E[f]=_,j[f]=Z,d=0;Z>d;++d)G[d+_]=f;_+=Z}s(u(a(i.groupNumList,void 0,o),T)),a(i.groupTypeList,N,o);var rr=0,tr=0;for(f=0;w>f;++f){var nr=b[N[f]],er=nr.atomInfo,ar=er.length/2,or=nr.bondIndices,ir=nr.bondOrders;for(d=0,y=ir.length;y>d;++d)m[tr]=rr+or[2*d],p[tr]=rr+or[2*d+1],C[tr]=ir[d],tr+=1;for(z[f]=rr,D[f]=ar,d=0;ar>d;++d)I[rr]=f,rr+=1}if(i.bondAtomList){if(i.bondOrderList){var ur=i.bondOrderList;C.set(ur,tr)}var sr=a(i.bondAtomList,void 0,o);for(f=0,g=sr.length;g>f;f+=2)m[tr]=sr[f],p[tr]=sr[f+1],tr+=1}return{bondStore:{atomIndex1:m,atomIndex2:p,bondOrder:C},atomStore:{groupIndex:I,xCoord:L,yCoord:S,zCoord:F,bFactor:O,atomId:x,altLabel:M,insCode:B,occupancy:P},groupStore:{chainIndex:G,atomOffset:z,atomCount:D,groupTypeId:N,groupNum:T,secStruct:V},chainStore:{modelIndex:k,groupOffset:E,groupCount:j,chainName:q},modelStore:{chainOffset:H,chainCount:J},groupMap:b,unitCell:i.unitCell,spaceGroup:i.spaceGroup,bioAssembly:i.bioAssembly,pdbId:i.pdbId,title:i.title,numBonds:v,numAtoms:h,numGroups:w,numChains:U,numModels:A}}return g}();