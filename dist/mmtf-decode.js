!function(r,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):r.decodeMmtf=t()}(this,function(){"use strict";function r(r){return new Uint8Array(r.buffer,r.byteOffset,r.byteLength)}function t(r){return new Int8Array(r.buffer,r.byteOffset,r.byteLength)}function e(r,t){var e,n,o,i=(r.byteOffset,r.byteLength);for(t||(t=new Int16Array(i/2)),e=0,n=0,o=i/2;o>e;++e,n+=2)t[e]=r[n]<<8^r[n+1]<<0;return t}function n(r,t){var e,n,o,i=(r.byteOffset,r.byteLength);for(t||(t=new Int32Array(i/4)),e=0,n=0,o=i/4;o>e;++e,n+=4)t[e]=r[n]<<24^r[n+1]<<16^r[n+2]<<8^r[n+3]<<0;return t}function o(r){return new Int32Array(r.buffer,r.byteOffset,r.byteLength/4)}function i(r,t,e){var n=r.length,o=1/t;e||(e=new Float32Array(n));for(var i=0;n>i;++i)e[i]=r[i]*o;return e}function a(r,t){var e,n;if(!t){var o=0;for(e=0,n=r.length;n>e;e+=2)o+=r[e+1];t=new r.constructor(o)}var i=0;for(e=0,n=r.length;n>e;e+=2)for(var a=r[e],u=r[e+1],s=0;u>s;++s)t[i]=a,i+=1;return t}function u(r){for(var t=1,e=r.length;e>t;++t)r[t]+=r[t-1];return r}function s(r,t,e){var n=r.length/2+t.length;e||(e=new Int32Array(n));for(var o=0,i=0,a=0,u=r.length;u>a;a+=2){var s=r[a],f=r[a+1];e[o]=s,0!==a&&(e[o]+=e[o-1]),o+=1;for(var d=0;f>d;++d)e[o]=e[o-1]+t[i],o+=1,i+=1}return e}function f(r,t,a,u){var f=r.length/4/2+t.length/2;u||(u=new Float32Array(f));var d=o(u),c=s(n(r),e(t),d);return i(c,a,u)}function d(r,t,e){var u=e?o(e):void 0,s=a(n(r),u);return i(s,t,e)}function c(e,o){function i(r){return s?-1===s.indexOf(r):!0}o=o||{};var s=o.ignoreFields,c=(e.numBonds||0,e.numAtoms||0),y=e.groupTypeList.length/4,v=e.chainIdList.length/4,L=e.chainsPerModel.length,g={numGroups:y,numChains:v,numModels:L};l.forEach(function(r){void 0!==e[r]&&(g[r]=e[r])});var h="bondAtomList";e[h]&&i(h)&&(g[h]=n(e[h]));var m="bondOrderList";e[m]&&i(m)&&(g[m]=r(e[m])),g.xCoordList=f(e.xCoordBig,e.xCoordSmall,1e3),g.yCoordList=f(e.yCoordBig,e.yCoordSmall,1e3),g.zCoordList=f(e.zCoordBig,e.zCoordSmall,1e3);var b="bFactorList",p="bFactorBig",A="bFactorSmall";e[p]&&e[A]&&i(b)&&(g[b]=f(e[p],e[A],100));var C="atomIdList";e[C]&&i(C)&&(g[C]=u(a(n(e[C]))));var I="altLocList";e[I]&&i(I)&&(g[I]=a(n(e[I]),new Uint8Array(c)));var w="occupancyList";e[w]&&i(w)&&(g[w]=d(e[w],100)),g.groupIdList=u(a(n(e.groupIdList))),g.groupTypeList=n(e.groupTypeList);var x="secStructList";e[x]&&i(x)&&(g[x]=t(e[x]));var F="insCodeList";e[F]&&i(F)&&(g[F]=a(n(e[F]),new Uint8Array(y)));var O="sequenceIndexList";e[O]&&i(O)&&(g[O]=u(a(n(e[O])))),g.chainIdList=r(e.chainIdList);var B="chainNameList";return e[B]&&i(B)&&(g[B]=r(e[B])),g}var l=["mmtfVersion","mmtfProducer","unitCell","spaceGroup","structureId","title","depositionDate","releaseDate","experimentalMethods","resolution","rFree","rWork","bioAssemblyList","entityList","groupList","numBonds","numAtoms","groupsPerChain","chainsPerModel"];return c});