!function(r,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):r.encodeMmtf=e()}(this,function(){"use strict";function r(r,e){var t=r.length;e||(e=new Uint8Array(2*t));for(var n=new DataView(e.buffer,e.byteOffset,e.byteLength),o=0;t>o;++o)n.setInt16(2*o,r[o]);return e.buffer}function e(r,e){var t=r.length;e||(e=new Uint8Array(4*t));for(var n=new DataView(e.buffer,e.byteOffset,e.byteLength),o=0;t>o;++o)n.setInt32(4*o,r[o]);return e.buffer}function t(r,e,t,n){t||(t=4);var o=r.length,i=new ArrayBuffer(o*t),a=new DataView(i),f="setInt32";1===t?f="setInt8":2===t&&(f="setInt16");for(var u=0;o>u;++u)a[f](t*u,Math.round(r[u]*e),n);return i}function n(r){if(0===r.length)return new ArrayBuffer;var e,t,n=2;for(e=1,t=r.length;t>e;++e)r[e-1]!==r[e]&&(n+=2);var o=new ArrayBuffer(4*n),i=new DataView(o),a=0,f=1;for(e=1,t=r.length;t>e;++e)r[e-1]!==r[e]?(i.setInt32(a,r[e-1]),i.setInt32(a+4,f),f=1,a+=8):f+=1;return i.setInt32(a,r[r.length-1]),i.setInt32(a+4,f),o}function o(r,e){e||(e=new r.constructor(r.length)),e[0]=r[0];for(var t=1,n=e.length;n>t;++t)e[t]=r[t]-r[t-1];return e}function i(t,n){var i,a,f=n?127:32767,u=n?Int8Array:Int16Array,s=o(t),y=0,d=0;for(i=0,a=s.length;a>i;++i){var l=s[i];l>f||-f>l?y+=2:d+=1}var w=new Int32Array(y),c=new u(d),g=0,h=0;for(i=0,a=s.length;a>i;++i){var l=s[i];l>f||-f>l?(w[g]=l,w[g+1]=0,g+=2):(c[h]=l,h+=1,w[g-1]+=1)}return[e(w,w),n?c:r(c,c)]}function a(r,e,n){var o=new Int32Array(t(r,e,4,!0));return i(o,n)}function f(r){var t={};u.forEach(function(e){void 0!==r[e]&&(t[e]=r[e])});var i=a(r.xCoordList,1e3);t.xCoordBig=new Uint8Array(i[0]),t.xCoordSmall=new Uint8Array(i[1]);var f=a(r.yCoordList,1e3);t.yCoordBig=new Uint8Array(f[0]),t.yCoordSmall=new Uint8Array(f[1]);var s=a(r.zCoordList,1e3);return t.zCoordBig=new Uint8Array(s[0]),t.zCoordSmall=new Uint8Array(s[1]),t.groupIdList=new Uint8Array(n(o(r.groupIdList))),t.groupTypeList=new Uint8Array(e(r.groupTypeList)),t.chainIdList=r.chainIdList,t}var u=["mmtfVersion","mmtfProducer","unitCell","spaceGroup","structureId","title","depositionDate","releaseDate","experimentalMethods","resolution","rFree","rWork","bioAssemblyList","entityList","groupList","numBonds","numAtoms","groupsPerChain","chainsPerModel"];return f});