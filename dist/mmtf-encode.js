!function(t,r){"object"==typeof exports&&"undefined"!=typeof module?module.exports=r():"function"==typeof define&&define.amd?define(r):t.encodeMmtf=r()}(this,function(){"use strict";function t(t,r){var e=t.length;r||(r=new Uint8Array(2*e));for(var n=new DataView(r.buffer,r.byteOffset,r.byteLength),i=0;e>i;++i)n.setInt16(2*i,t[i]);return r.buffer}function r(t,r){var e=t.length;r||(r=new Uint8Array(4*e));for(var n=new DataView(r.buffer,r.byteOffset,r.byteLength),i=0;e>i;++i)n.setInt32(4*i,t[i]);return r.buffer}function e(t,r,e,n){e||(e=4);var i=t.length,o=new ArrayBuffer(i*e),a=new DataView(o),s="setInt32";1===e?s="setInt8":2===e&&(s="setInt16");for(var u=0;i>u;++u)a[s](e*u,Math.round(t[u]*r),n);return o}function n(t){if(0===t.length)return new ArrayBuffer;var r,e,n=2;for(r=1,e=t.length;e>r;++r)t[r-1]!==t[r]&&(n+=2);var i=new ArrayBuffer(4*n),o=new DataView(i),a=0,s=1;for(r=1,e=t.length;e>r;++r)t[r-1]!==t[r]?(o.setInt32(a,t[r-1]),o.setInt32(a+4,s),s=1,a+=8):s+=1;return o.setInt32(a,t[t.length-1]),o.setInt32(a+4,s),i}function i(t,r){r||(r=new t.constructor(t.length)),r[0]=t[0];for(var e=1,n=r.length;n>e;++e)r[e]=t[e]-t[e-1];return r}function o(e,n){if(0===e.length)return[new ArrayBuffer,new ArrayBuffer];var o,a,s=n?127:32767,u=n?Int8Array:Int16Array,f=i(e),c=2,y=0;for(o=1,a=f.length;a>o;++o){var d=f[o];d>s||-s>d?c+=2:y+=1}var L=new Int32Array(c),w=new u(y),A=0,l=0;for(L[A]=f[0],L[A+1]=0,A+=2,o=1,a=f.length;a>o;++o){var d=f[o];d>s||-s>d?(L[A]=d,L[A+1]=0,A+=2):(w[l]=d,l+=1,L[A-1]+=1)}return[r(L,L),n?w:t(w,w)]}function a(t,r,n){var i=new Int32Array(e(t,r,4,!0));return o(i,n)}function s(t){var o={};u.forEach(function(r){void 0!==t[r]&&(o[r]=t[r])}),t.bondAtomList&&(o.bondAtomList=new Uint8Array(r(t.bondAtomList))),t.bondOrderList&&(o.bondOrderList=new Uint8Array(t.bondOrderList.buffer));var s=a(t.xCoordList,1e3);o.xCoordBig=new Uint8Array(s[0]),o.xCoordSmall=new Uint8Array(s[1]);var f=a(t.yCoordList,1e3);o.yCoordBig=new Uint8Array(f[0]),o.yCoordSmall=new Uint8Array(f[1]);var c=a(t.zCoordList,1e3);if(o.zCoordBig=new Uint8Array(c[0]),o.zCoordSmall=new Uint8Array(c[1]),t.bFactorList){var y=a(t.bFactorList,100);o.bFactorBig=new Uint8Array(y[0]),o.bFactorSmall=new Uint8Array(y[1])}return t.atomIdList&&(o.atomIdList=new Uint8Array(n(i(t.atomIdList)))),t.altLocList&&(o.altLocList=new Uint8Array(n(t.altLocList))),t.occupancyList&&(o.occupancyList=new Uint8Array(n(new Int32Array(e(t.occupancyList,100,4,!0))))),o.groupIdList=new Uint8Array(n(i(t.groupIdList))),o.groupTypeList=new Uint8Array(r(t.groupTypeList)),t.secStructList&&(o.secStructList=new Uint8Array(t.secStructList.buffer)),t.insCodeList&&(o.insCodeList=new Uint8Array(n(t.insCodeList))),t.sequenceIndexList&&(o.sequenceIndexList=new Uint8Array(n(i(t.sequenceIndexList)))),o.chainIdList=new Uint8Array(t.chainIdList.buffer),t.chainNameList&&(o.chainNameList=new Uint8Array(t.chainNameList.buffer)),o}var u=["mmtfVersion","mmtfProducer","unitCell","spaceGroup","structureId","title","depositionDate","releaseDate","experimentalMethods","resolution","rFree","rWork","bioAssemblyList","entityList","groupList","numBonds","numAtoms","groupsPerChain","chainsPerModel"];return s});